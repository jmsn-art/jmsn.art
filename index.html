<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FQPZNDPCCF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-FQPZNDPCCF');
</script>

<style>
  body{margin:0;padding:20px;background:#111;color:#fff;font-family:Arial,Helvetica,sans-serif}
  .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}
  .gallery img{width:100%;height:auto;display:block;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.5);cursor:pointer;transition:transform .25s}
  .gallery img:hover{transform:scale(1.04)}

  /* Lightbox */
  .lb{display:none;position:fixed;inset:0;background:rgba(0,0,0,.92);z-index:9999;align-items:center;justify-content:center}
  .lb img{display:block;max-width:92%;max-height:80vh}
  .close{position:fixed;top:14px;right:24px;font-size:40px;color:#fff;cursor:pointer}

  /* Fade-in animation */
  .fade-in{opacity:0;animation:fadeIn .8s forwards}
  @keyframes fadeIn{to{opacity:1}}

  /* Lock background scroll when lightbox open */
  .noscroll{overflow:hidden}
</style>
</head>
<body>

<div class="gallery" id="gallery">
  <!-- Your 138 <img> tags go here exactly as before -->
</div>

<div class="lb" id="lb">
  <span class="close" id="x">&times;</span>
  <img id="lbimg" alt="">
</div>

<footer style="text-align:center;margin:40px 0 10px;opacity:.8;font-size:14px;letter-spacing:.2px">
  © 2025 Jameson McShane · 
  <a href="contact.html" style="color:#fff;text-decoration:underline">Contact</a>
</footer>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const gallery = document.getElementById('gallery');
    let items = Array.from(gallery.children);

    // Cache-bust so refreshes always fetch fresh order
    const v = Date.now();
    items.forEach(img => { img.src = `${img.src}?v=${v}`; });

    // Enable native lazy-loading
    items.forEach(img => { img.loading = 'lazy'; });

    // Fisher–Yates shuffle
    for (let i = items.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [items[i], items[j]] = [items[j], items[i]];
    }

    // Re-append in shuffled order with staggered fade-in
    items.forEach((img, idx) => {
      img.classList.add('fade-in');
      img.style.animationDelay = `${idx * 0.15}s`;
      gallery.appendChild(img);
    });

    // Lightbox + arrow key nav
    const lb = document.getElementById('lb');
    const lbimg = document.getElementById('lbimg');
    const closeBtn = document.getElementById('x');
    let current = 0;

    function bestSrc(el){ return el.dataset.full || el.src; }

    items.forEach((img, idx) => {
      img.addEventListener('click', () => {
        current = idx;
        lb.style.display = 'flex';
        lbimg.src = bestSrc(img);
        document.body.classList.add('noscroll');
      });
    });

    function showAt(i){
      current = (i + items.length) % items.length;
      lbimg.src = bestSrc(items[current]);
    }

    function closeLB(){
      lb.style.display = 'none';
      document.body.classList.remove('noscroll');
    }

    closeBtn.addEventListener('click', closeLB);
    lb.addEventListener('click', e => { if (e.target === lb) closeLB(); });

    document.addEventListener('keydown', e => {
      if (lb.style.display === 'flex') {
        if (e.key === 'ArrowRight') showAt(current + 1);
        if (e.key === 'ArrowLeft')  showAt(current - 1);
        if (e.key === 'Escape')     closeLB();
      }
    });
  });
</script>
</body>
</html>
