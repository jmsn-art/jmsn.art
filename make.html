<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Make an Art Circle – jmsn.art</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <style>
    :root { --bg:#111; --fg:#fff; --gold:#d4af37; }
    html, body { height:100%; }
    body {
      margin:0; background:var(--bg); color:var(--fg);
      font-family: Arial, Helvetica, sans-serif; display:flex; flex-direction:column;
    }
    header, footer {
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:14px 18px; font-size:14px; opacity:.9;
    }
    header a, footer a { color:var(--fg); text-decoration:underline; }
    .wrap {
      flex:1; display:flex; align-items:center; justify-content:center; padding:10px;
    }
    .panel {
      width:min(92vw, 980px);
      display:grid; grid-template-columns:1fr; gap:14px;
      align-items:center; justify-items:center;
    }
    .controls {
      display:flex; gap:10px; flex-wrap:wrap; justify-content:center;
    }
    button {
      background:#222; color:#fff; border:1px solid #333; border-radius:10px;
      padding:10px 14px; cursor:pointer; letter-spacing:.3px;
      box-shadow:0 4px 12px rgba(0,0,0,.4); transition:transform .12s ease, background .2s ease;
    }
    button:hover { transform:translateY(-1px); background:#1a1a1a; }
    svg {
      width:min(92vw, 900px); height:auto; border-radius:12px;
      box-shadow:0 10px 30px rgba(0,0,0,.6);
      background:#0b0b0b;
    }
    /* subtle appear animation */
    .fade-in { animation: fade .7s ease forwards; opacity:0; }
    @keyframes fade { to { opacity:1 } }
    /* tiny helper text */
    .hint { opacity:.7; font-size:12px; text-align:center; }
  </style>
</head>
<body>
  <header>
    <a href="/">← Back to Gallery</a>
    <div>Make an Art Circle</div>
    <div style="width:80px"></div>
  </header>

  <div class="wrap">
    <div class="panel">
      <div class="controls">
        <button id="makeBtn">Make an Art Circle</button>
        <button id="saveSvgBtn" title="Download as SVG">Save SVG</button>
      </div>
      <div id="stage" aria-live="polite"></div>
      <div class="hint">Tip: press <kbd>R</kbd> to generate again.</div>
    </div>
  </div>

  <footer>
    <span>© 2025 Jameson McShane</span>
    <a href="about.html">About</a>
  </footer>

  <script>
    // Utilities
    const rand = (min, max) => Math.random() * (max - min) + min;
    const randInt = (min, max) => Math.floor(rand(min, max + 1));
    const choice = arr => arr[randInt(0, arr.length - 1)];

    function makeSVGArt() {
      const size = 900;
      const svgNS = "http://www.w3.org/2000/svg";
      const svg = document.createElementNS(svgNS, "svg");
      svg.setAttribute("viewBox", `0 0 ${size} ${size}`);
      svg.setAttribute("role", "img");
      svg.setAttribute("aria-label", "Generated art circle composition");
      svg.classList.add('fade-in');

      const defs = document.createElementNS(svgNS, "defs");

      // Soft glow filter
      const filter = document.createElementNS(svgNS, "filter");
      filter.setAttribute("id", "glow");
      const fe = document.createElementNS(svgNS, "feGaussianBlur");
      fe.setAttribute("stdDeviation", "2.2");
      fe.setAttribute("result", "coloredBlur");
      filter.appendChild(fe);

      const feMerge = document.createElementNS(svgNS, "feMerge");
      ["coloredBlur", "SourceGraphic"].forEach(inp => {
        const feMNode = document.createElementNS(svgNS, "feMergeNode");
        feMNode.setAttribute("in", inp);
        feMerge.appendChild(feMNode);
      });
      filter.appendChild(feMerge);
      defs.appendChild(filter);

      // Gold gradient (slight)
      const grad = document.createElementNS(svgNS, "radialGradient");
      grad.setAttribute("id", "gold");
      grad.setAttribute("cx", "50%"); grad.setAttribute("cy", "50%");
      grad.setAttribute("r", "60%");
      const stops = [
        ["0%",   "#f6e27a"],
        ["35%",  "#e7c96a"],
        ["70%",  "#d4af37"],
        ["100%", "#a98a26"]
      ];
      stops.forEach(([off, col]) => {
        const s = document.createElementNS(svgNS, "stop");
        s.setAttribute("offset", off); s.setAttribute("stop-color", col);
        grad.appendChild(s);
      });
      defs.appendChild(grad);

      // Subtle vignette
      const vignette = document.createElementNS(svgNS, "radialGradient");
      vignette.setAttribute("id", "vignette");
      vignette.setAttribute("cx", "50%"); vignette.setAttribute("cy", "50%");
      vignette.setAttribute("r", "70%");
      const vStops = [
        ["70%", "rgba(0,0,0,0)"],
        ["100%", "rgba(0,0,0,0.45)"]
      ];
      vStops.forEach(([off, col]) => {
        const s = document.createElementNS(svgNS, "stop");
        s.setAttribute("offset", off); s.setAttribute("stop-color", col);
        vignette.appendChild(s);
      });
      defs.appendChild(vignette);

      svg.appendChild(defs);

      // Background
      const bg = document.createElementNS(svgNS, "rect");
      bg.setAttribute("x", 0); bg.setAttribute("y", 0);
      bg.setAttribute("width", size); bg.setAttribute("height", size);
      bg.setAttribute("fill", "#0b0b0b");
      svg.appendChild(bg);

      // Center
      const cx = size/2, cy = size/2;

      // Draw a stack of broken rings
      const ringCount = randInt(3, 6);
      for (let i = 0; i < ringCount; i++) {
        const radius = rand(120, 360) + i * rand(18, 26);
        const strokeW = rand(3, 12);

        // Use a circle with stroke-dasharray to create "broken" segments
        const circ = document.createElementNS(svgNS, "circle");
        circ.setAttribute("cx", cx);
        circ.setAttribute("cy", cy);
        circ.setAttribute("r", radius.toFixed(2));
        circ.setAttribute("fill", "none");
        circ.setAttribute("stroke", "url(#gold)");
        circ.setAttribute("stroke-width", strokeW.toFixed(2));
        const dash = rand(18, 90).toFixed(1);
        const gap  = rand(30, 160).toFixed(1);
        circ.setAttribute("stroke-dasharray", `${dash} ${gap}`);
        circ.setAttribute("transform", `rotate(${rand(0,360).toFixed(1)} ${cx} ${cy})`);
        circ.setAttribute("filter", "url(#glow)");
        svg.appendChild(circ);
      }

      // Optional branching lines inside (subtle, low opacity)
      const branchCount = randInt(5, 12);
      for (let i = 0; i < branchCount; i++) {
        const angle = rand(0, Math.PI * 2);
        const len = rand(80, 220);
        const x1 = cx + Math.cos(angle) * rand(0, 40);
        const y1 = cy + Math.sin(angle) * rand(0, 40);
        const x2 = cx + Math.cos(angle + rand(-0.35, 0.35)) * (len + rand(-20, 30));
        const y2 = cy + Math.sin(angle + rand(-0.35, 0.35)) * (len + rand(-20, 30));

        const path = document.createElementNS(svgNS, "path");
        const mx = (x1 + x2) / 2 + rand(-30, 30);
        const my = (y1 + y2) / 2 + rand(-30, 30);
        path.setAttribute("d", `M ${x1.toFixed(1)} ${y1.toFixed(1)} Q ${mx.toFixed(1)} ${my.toFixed(1)} ${x2.toFixed(1)} ${y2.toFixed(1)}`);
        path.setAttribute("stroke", "url(#gold)");
        path.setAttribute("stroke-width", rand(0.6, 2.0).toFixed(2));
        path.setAttribute("stroke-linecap", "round");
        path.setAttribute("fill", "none");
        path.setAttribute("opacity", rand(0.15, 0.5).toFixed(2));
        svg.appendChild(path);
      }

      // Central halo (solid with a gap via stroke-dasharray)
      const halo = document.createElementNS(svgNS, "circle");
      halo.setAttribute("cx", cx);
      halo.setAttribute("cy", cy);
      halo.setAttribute("r", rand(70, 140).toFixed(1));
      halo.setAttribute("fill", "none");
      halo.setAttribute("stroke", "url(#gold)");
      halo.setAttribute("stroke-width", rand(6, 12).toFixed(1));
      halo.setAttribute("stroke-dasharray", `${rand(60,140).toFixed(1)} ${rand(80,190).toFixed(1)}`);
      halo.setAttribute("transform", `rotate(${rand(0,360).toFixed(1)} ${cx} ${cy})`);
      halo.setAttribute("filter", "url(#glow)");
      svg.appendChild(halo);

      // Star dust: a few faint dots
      const stars = randInt(12, 28);
      for (let i = 0; i < stars; i++) {
        const r = rand(1.0, 2.8);
        const a = rand(0, Math.PI * 2);
        const dist = rand(160, 410);
        const x = cx + Math.cos(a) * dist;
        const y = cy + Math.sin(a) * dist;
        const dot = document.createElementNS(svgNS, "circle");
        dot.setAttribute("cx", x.toFixed(1));
        dot.setAttribute("cy", y.toFixed(1));
        dot.setAttribute("r", r.toFixed(1));
        dot.setAttribute("fill", "url(#gold)");
        dot.setAttribute("opacity", rand(0.25, 0.6).toFixed(2));
        svg.appendChild(dot);
      }

      // Vignette overlay
      const vig = document.createElementNS(svgNS, "rect");
      vig.setAttribute("x", 0); vig.setAttribute("y", 0);
      vig.setAttribute("width", size); vig.setAttribute("height", size);
      vig.setAttribute("fill", "url(#vignette)");
      svg.appendChild(vig);

      return svg;
    }

    function render() {
      const stage = document.getElementById("stage");
      stage.innerHTML = "";
      stage.appendChild(makeSVGArt());
    }

    // Actions
    document.getElementById("makeBtn").addEventListener("click", render);
    document.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "r") render();
    });

    // Save SVG
    document.getElementById("saveSvgBtn").addEventListener("click", () => {
      const svg = document.querySelector("#stage svg");
      if (!svg) return;
      const serializer = new XMLSerializer();
      let source = serializer.serializeToString(svg);

      // Add namespace if missing
      if (!source.match(/^<svg[^>]+xmlns=/)) {
        source = source.replace(/^<svg/, '<svg xmlns="http://www.w3.org/2000/svg"');
      }
      // Pretty filename with timestamp
      const name = `art-circle-${Date.now()}.svg`;
      const url = URL.createObjectURL(new Blob([source], {type: "image/svg+xml;charset=utf-8"}));
      const link = Object.assign(document.createElement("a"), { href:url, download:name });
      document.body.appendChild(link);
      link.click();
      link.remove();
      URL.revokeObjectURL(url);
    });

    // First render on load
    render();
  </script>
</body>
</html>
